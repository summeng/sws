KISSY.add("placeholder",function(a){function g(a,d){var g=b.get(d.elLabel),h=g.parentNode,i=b.get(a);if(!g||!i)return;c.on(g,"click",function(){i.focus()}),c.on(i,"blur",function(){b.removeClass(h,f),i.value===""&&b.removeClass(h,e)}),c.on(i,"focus",function(){b.addClass(h,f)}),c.on(i,"keydown",function(a){a&&a.keyCode!==9&&setTimeout(function(){b.addClass(h,e)},0)}),i.value===""&&b.removeClass(h,e),setInterval(function(){i.value!==""&&b.addClass(h,e)},1111)}var b=a.DOM,c=a.Event,d=a.namespace("ui"),e="ph-hide",f="ph-focus";return d.PlaceHolder=g,g},{requires:["core"]});KISSY.add("ui/wordcounter",function(a){function c(b){var c=this;c.lock=!1,c.elti=a.one(b),c.count=c.elti.val().length,c.elti.on("keyup",c._keyup,c),c.elti[0].tagName.toLowerCase()==="textarea"&&(c.maxlength=c.elti.attr("maxlength"),c.initTextarea())}var b=a.namespace("ui");return a.augment(c,a.EventTarget,{_keyup:function(a){var b=this;b.updateCount(),b.fire("countupdate",{count:b.count})},updateCount:function(){this.count=this.elti.val().length},initTextarea:function(){var a=this,b;a.elti.on("keyup",function(){b=a.elti.val(),b.length>a.maxlength&&a.elti.val(b.substr(0,a.maxlength))})}}),b.WordCounter=c,c});KISSY.add("ui/simplestar",function(a){function n(c){var d=this;d.elCtl=a.one(b.create('<div class="ks-ss-tooltip">tooltip</div>')),a.ready(function(){d.elCtl.appendTo(document.body)}),this.to=null}var b=a.DOM,c=a.namespace("ui"),d="http://img03.taobaocdn.com/tps/i3/T1eMt9XclyXXXXXXXX-19-19.png",e="http://img02.taobaocdn.com/tps/i2/T1j_SkXl0fXXXXXXXX-19-19.png",f="http://img01.taobaocdn.com/tps/i1/T1lgl9XfXyXXXXXXXX-19-19.png",g="ks-ss-focus",h="change",i="hoverchange",j=1,k={tmpl:"<dl><dt>{score}\u5206 {levelText}</dt><dd>{tooltip}</dd></dl>",tipstmpl:"<strong>{score}\u5206</strong> - {tooltip}"},l=new n,m=c.SimpleStar=function(c,d){var f=this;f.el=a.one(c),f.config=a.merge(k,d),f.inputs=f.el.all("input");var g=b.create('<span class="ks-simplestar" />');f.images=[],f.hoverIndex=-1,f.checked=-1,f.elCtl=a.one(g),f.elCtl.insertAfter(f.el),d.el_tip?f.elTips=a.one(d.el_tip):(f.elTips=a.one('<span class="ks-ss-tips" />'),f.elTips.insertAfter(f.elCtl)),f.el.css("position","absolute").css("left","-9999px"),f.inputs.each(function(a){var b=new Image;b.src=e,f.images.push(b),f.elCtl.append(b)}),a.later(function(){f.initEvent()},10)};return a.augment(m,a.EventTarget,{initEvent:function(){var b=this,c=b.elCtl;b.on(h,function(a){b.renderStar(),b.renderTips(a)}).on(i,function(c){b.renderStar(),c.hoverIndex!==-1?l.show(this.images[c.hoverIndex],a.substitute(b.config.tmpl,c)):l.hide()}),b.monitorRadios(),b.inputs.on("click",function(a){b.monitorRadios()}).on("focus",function(a){c.addClass(g)}).on("blur",function(a){c.removeClass(g)}),c.on("click",function(c){var d=a.one(c.target),e=a.indexOf(d[0],b.images);e!==-1&&(b.inputs[e].checked=!0,b.monitorRadios(),l.hide())}).on("mouseover",function(c){var d=a.one(c.target);if(d[0].tagName.toLowerCase()=="img"){var e=a.indexOf(d[0],b.images);b.hoverIndex=e,b.fire(i,{hoverIndex:e,score:e+1,levelText:b.getLevel(e),tooltip:b.getTooltip(e)})}}).on("mouseleave",function(){b.hoverIndex=-1,b.fire(i,{hoverIndex:b.hoverIndex})}),a.each(b.inputs,function(c,d){a.one(c).attr("title",b.getLevel(d)+"\uff0c"+b.getTooltip(d))})},monitorRadios:function(){var a=this,b=a.index();b!==a.checked&&(a.checked=b,a.fire(h,{score:b+1,levelText:a.getLevel(b),tooltip:a.getTooltip(b),index:b}))},index:function(){var b=this,c=-1;return b.inputs.each(function(b,d){a.one(b)[0].checked&&(c=d)}),c},renderStar:function(){var b=this,c=b.hoverIndex!==-1?b.hoverIndex:b.checked;a.each(b.images,function(a,b){var g=e;c>=0&&c<=j&&b<=c&&(g=f),c>=0&&c>j&&b<=c&&(g=d),a.src=g})},renderTips:function(b){var c=this;c.elTips.html(a.substitute(c.config.tipstmpl,b))},getTooltip:function(a){var b=this;return b.config.tooltips[a]||a},getLevel:function(a){var b=this;return b.config.levelText[a]||a}}),a.augment(n,{show:function(c,d){var e=this;e.to&&(e.to.cancel(),e.to=null),d&&e.elCtl.html(d);var f=b.width(c),g=b.height(c),h=b.offset(c);e.elCtl.css("display","block"),e.to=a.later(function(){e.to=null;var a=e.elCtl.width();e.elCtl.offset({left:h.left+f/2-a*.5-3,top:h.top+g+2}),e.elCtl.css("visibility","visible")},10)},hide:function(){var b=this;b.to&&(b.to.cancel(),b.to=null),b.to=a.later(function(){b.to=null,b.elCtl.css("visibility","hidden").css("display","none")},100)}}),m});KISSY.add("util/LoginCheck",function(a){function d(a){this.callbackurl=a.callbackURL,this.ajaxurl=a.ajaxURL,this.checkDialog=null,this.callbackurl.indexOf("?")===-1&&(this.callbackurl+="?"),this.callbackurl=this.callbackurl.replace(/&?$/,"&callbackFn="+b),this.loginSuccess=a.success,this.cancel=a.cancel}var b="ksLoginSuccessCallback",c=a.namespace("util");return c.LoginCheck=d,a.augment(d,{start:function(){var b=this;a.io({url:this.ajaxurl,dataType:"json",type:"post",success:function(a){a.isLogin?b.loginSuccess():b.useCallback()},error:function(){this.useCallback()}})},useCallback:function(){var c=this;window[b]=c.loginSuccess,c.checkDialog?c.checkDialog.show():a.use("overlay",function(a){c.checkDialog=(new a.Dialog({width:400,bodyContent:'<iframe src="'+c.callbackurl+'" width="400" height="300" scrolling="no" frameborder="0"></iframe>',align:{points:["cc","cc"]}})).on("hide",function(){window[b]===c.loginSuccess&&(window[b]=null,c.cancel())}).show()})},loginSuccess:function(){a.log("\u767b\u5f55\u786e\u8ba4")}}),d});